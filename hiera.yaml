version: 4
datadir: hieradata
hierarchy:

  - name: "Secure Node"
    backend: yaml
    path: "secure/nodes/%{trusted.certname}"

  - name: "Node"
    backend: yaml
    path: "nodes/%{trusted.certname}"

  - name: "Secure Roles"
    backend: yaml
    path: "secure/roles/%{::role}"

  - name: "Role"
    backend: yaml
    path: "secure/roles/%{::role}"

  - name: "Secrure OS Family"
    backend: yaml
    path: "secure/os/%{facts.os.family}"

  - name: "OS Family"
    backend: yaml
    path: "os/%{facts.os.family}"

  - name: "Secure Common"
    backend: yaml
    path: "secure/common"

  - name: "Common"
    backend: yaml
    path: "common"